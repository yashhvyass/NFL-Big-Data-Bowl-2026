# ğŸˆ NFL Big Data Bowl 2026 - Kaggle x AWS

---

# ğŸ“– Table of Contents

1. [What Are We Trying to Do?](#-what-are-we-trying-to-do)
2. [The Big Picture](#-the-big-picture-end-to-end-pipeline)
3. [Understanding the Data](#-understanding-the-data)
4. [Model 1: CumsumModel (Conv + GRU + Attention)](#-model-1-cumsummodel)
5. [Model 2: GRU + Attention (SeqModel)](#-model-2-gru--attention-seqmodel)
6. [Model 3: GNN-Enhanced Transformer](#-model-3-gnn-enhanced-transformer)
7. [Model 4: Spatio-Temporal Transformer](#-model-4-spatio-temporal-transformer)
8. [The Final Ensemble](#-the-final-ensemble)
9. [Glossary of Terms](#-glossary-of-terms)

---

# ğŸ¯ What Are We Trying to Do?

## The Problem in Simple Terms

Imagine you're watching a football game. The quarterback throws the ball, and it's flying through the air. **Where will each player be when the ball lands?**

That's exactly what we're predicting! 

```
BEFORE THE THROW                          AFTER THE THROW (What we predict)
                                          
    ğŸƒ Receiver                               ğŸƒ â†’ â†’ â†’ â†’ ğŸƒ Receiver catches!
         â†˜                                              â†—
    ğŸˆ QB throws â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ ğŸˆ Ball lands here
         â†—                                              â†˜  
    ğŸƒ Defender                               ğŸƒ â†’ â†’ â†’ â†’ ğŸƒ Defender arrives
```

### What Information Do We Have?

**GIVEN (Input):**
- Where every player is RIGHT NOW (x, y coordinates)
- How fast they're moving (speed)
- Which direction they're going (direction)
- Where the ball will land (ball_land_x, ball_land_y)
- Who is the targeted receiver
- Player physical attributes (height, weight)

**PREDICT (Output):**
- Where each player will be at EVERY FRAME until the ball lands
- Football tracking runs at 10 frames per second
- So if the ball is in the air for 3 seconds, we predict 30 positions!

---

# ğŸ—ºï¸ The Big Picture: End-to-End Pipeline

Here's how data flows from raw tracking data to final predictions:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                           COMPLETE SYSTEM ARCHITECTURE                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ğŸ“¥ STAGE 1: DATA INPUT                              â”‚
â”‚                                                                                  â”‚
â”‚   NFL provides tracking data files:                                              â”‚
â”‚   â€¢ input_2023_w01.csv  â†’ Player positions BEFORE the throw                     â”‚
â”‚   â€¢ output_2023_w01.csv â†’ Player positions AFTER the throw (training only)      â”‚
â”‚                                                                                  â”‚
â”‚   Each row contains:                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚ game_id â”‚ play_id â”‚ nfl_id â”‚ frame_id â”‚  x  â”‚  y  â”‚  s  â”‚  a  â”‚ dir â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                                  â”‚
â”‚   Think of it like a GPS tracker on every player, recording their position      â”‚
â”‚   10 times per second!                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ”„ STAGE 2: PLAY DIRECTION FIX                           â”‚
â”‚                                                                                  â”‚
â”‚   Problem: Some teams attack LEFT, others attack RIGHT                           â”‚
â”‚   Solution: Flip all plays so everyone attacks the SAME direction               â”‚
â”‚                                                                                  â”‚
â”‚   BEFORE (Mixed directions):          AFTER (All unified):                       â”‚
â”‚                                                                                  â”‚
â”‚   Play 1: â† â† â† ğŸˆ                    Play 1: ğŸˆ â†’ â†’ â†’                           â”‚
â”‚   Play 2: ğŸˆ â†’ â†’ â†’         ====>      Play 2: ğŸˆ â†’ â†’ â†’                           â”‚
â”‚   Play 3: â† â† â† ğŸˆ                    Play 3: ğŸˆ â†’ â†’ â†’                           â”‚
â”‚                                                                                  â”‚
â”‚   Code: if play_direction == 'left':                                            â”‚
â”‚             x = 120 - x  # Flip horizontally                                    â”‚
â”‚             y = 53.3 - y # Flip vertically                                      â”‚
â”‚             dir = (dir + 180) % 360  # Reverse direction                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       âš™ï¸ STAGE 3: FEATURE ENGINEERING                            â”‚
â”‚                                                                                  â”‚
â”‚   Raw data has ~10 columns. We CREATE 150-200 new features!                     â”‚
â”‚                                                                                  â”‚
â”‚   Why? The model needs CONTEXT to make good predictions.                        â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  KINEMATIC       â”‚    â”‚  SPATIAL         â”‚    â”‚  TEMPORAL        â”‚         â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€        â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€        â”‚         â”‚
â”‚   â”‚  â€¢ velocity_x    â”‚    â”‚  â€¢ dist_to_ball  â”‚    â”‚  â€¢ x_lag1        â”‚         â”‚
â”‚   â”‚  â€¢ velocity_y    â”‚    â”‚  â€¢ angle_to_ball â”‚    â”‚  â€¢ x_lag2        â”‚         â”‚
â”‚   â”‚  â€¢ acceleration  â”‚    â”‚  â€¢ dist_to_opp   â”‚    â”‚  â€¢ speed_rolling â”‚         â”‚
â”‚   â”‚  â€¢ momentum      â”‚    â”‚  â€¢ field_zone    â”‚    â”‚  â€¢ direction_ema â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  TEAM-BASED      â”‚    â”‚  ROLE-BASED      â”‚    â”‚  GEOMETRIC       â”‚         â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚         â”‚
â”‚   â”‚  â€¢ ally_mean_x   â”‚    â”‚  â€¢ is_receiver   â”‚    â”‚  â€¢ geo_endpoint  â”‚         â”‚
â”‚   â”‚  â€¢ enemy_mean_y  â”‚    â”‚  â€¢ is_coverage   â”‚    â”‚  â€¢ required_vel  â”‚         â”‚
â”‚   â”‚  â€¢ team_spread   â”‚    â”‚  â€¢ is_passer     â”‚    â”‚  â€¢ velocity_err  â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                                  â”‚
â”‚   Example calculation:                                                           â”‚
â”‚   â€¢ velocity_x = speed Ã— sin(direction)  â† Breaking speed into components       â”‚
â”‚   â€¢ dist_to_ball = âˆš[(x - ball_x)Â² + (y - ball_y)Â²]  â† Pythagorean theorem     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ“Š STAGE 4: SEQUENCE CREATION                             â”‚
â”‚                                                                                  â”‚
â”‚   Neural networks need data in a specific format called "sequences"             â”‚
â”‚                                                                                  â”‚
â”‚   Think of it like this: To predict where someone will go,                      â”‚
â”‚   you need to see where they've BEEN (their recent history)                     â”‚
â”‚                                                                                  â”‚
â”‚   Window Size = 10-20 frames (1-2 seconds of history)                           â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚  SEQUENCE FOR ONE PLAYER                                        â”‚           â”‚
â”‚   â”‚                                                                 â”‚           â”‚
â”‚   â”‚  Frame -10: [x, y, vx, vy, dist_ball, ... 198 features]        â”‚           â”‚
â”‚   â”‚  Frame -9:  [x, y, vx, vy, dist_ball, ... 198 features]        â”‚           â”‚
â”‚   â”‚  Frame -8:  [x, y, vx, vy, dist_ball, ... 198 features]        â”‚           â”‚
â”‚   â”‚     ...           ...           ...                             â”‚           â”‚
â”‚   â”‚  Frame -1:  [x, y, vx, vy, dist_ball, ... 198 features]        â”‚           â”‚
â”‚   â”‚  Frame 0:   [x, y, vx, vy, dist_ball, ... 198 features] â† NOW  â”‚           â”‚
â”‚   â”‚                                                                 â”‚           â”‚
â”‚   â”‚  Shape: (window_size, num_features) = (10, 198)                â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                                  â”‚
â”‚   We create one sequence per player, per play                                   â”‚
â”‚   If there are 22 players and 1000 plays = 22,000 sequences!                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ğŸ“ STAGE 5: NORMALIZATION                                  â”‚
â”‚                                                                                  â”‚
â”‚   Problem: Features have VERY different scales                                  â”‚
â”‚   â€¢ Position (x): 0 to 120 yards                                               â”‚
â”‚   â€¢ Speed (s): 0 to 12 yards/second                                            â”‚
â”‚   â€¢ Direction: 0 to 360 degrees                                                â”‚
â”‚                                                                                  â”‚
â”‚   Neural networks work best when all numbers are similar scale!                â”‚
â”‚                                                                                  â”‚
â”‚   Solution: StandardScaler                                                      â”‚
â”‚   â€¢ Subtract the mean                                                          â”‚
â”‚   â€¢ Divide by standard deviation                                               â”‚
â”‚   â€¢ Result: All features centered around 0, mostly between -3 and +3           â”‚
â”‚                                                                                  â”‚
â”‚   BEFORE:                              AFTER:                                   â”‚
â”‚   x = 45.2 yards                       x = 0.23                                â”‚
â”‚   speed = 7.5 yd/s                     speed = 1.15                            â”‚
â”‚   direction = 270Â°                     direction = -0.87                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ğŸ§  STAGE 6: NEURAL NETWORK ENSEMBLE                          â”‚
â”‚                                                                                  â”‚
â”‚   We don't use just ONE model - we use SIX models and combine them!            â”‚
â”‚   (Like asking 6 experts and averaging their opinions)                         â”‚
â”‚                                                                                  â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚                          â”‚  Input Sequence â”‚                                    â”‚
â”‚                          â”‚   (10, 198)     â”‚                                    â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                   â”‚                                             â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚          â”‚                        â”‚                        â”‚                   â”‚
â”‚          â–¼                        â–¼                        â–¼                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ CumsumModel â”‚          â”‚  GRU+Attn   â”‚          â”‚GNN+Transformâ”‚           â”‚
â”‚   â”‚   (20%)     â”‚          â”‚   (16%)     â”‚          â”‚    (16%)    â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚          â”‚                        â”‚                        â”‚                   â”‚
â”‚          â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                   â”‚
â”‚          â”‚          â–¼             â–¼             â–¼          â”‚                   â”‚
â”‚          â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                   â”‚
â”‚          â”‚   â”‚ nfl_gru   â”‚ â”‚ nfl_gru3  â”‚ â”‚ nfl_2026  â”‚     â”‚                   â”‚
â”‚          â”‚   â”‚  (16%)    â”‚ â”‚  (16%)    â”‚ â”‚  (16%)    â”‚     â”‚                   â”‚
â”‚          â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â”‚                   â”‚
â”‚          â”‚         â”‚             â”‚             â”‚           â”‚                   â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                   â”‚                                             â”‚
â”‚                                   â–¼                                             â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                          â”‚   WEIGHTED    â”‚                                     â”‚
â”‚                          â”‚   AVERAGE     â”‚                                     â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                  â”‚                                              â”‚
â”‚                                  â–¼                                              â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚                     â”‚  Final (x, y) Prediction â”‚                               â”‚
â”‚                     â”‚     for 94 frames        â”‚                               â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ğŸ”™ STAGE 7: POST-PROCESSING                                â”‚
â”‚                                                                                  â”‚
â”‚   1. CUMULATIVE SUM                                                             â”‚
â”‚      Model predicts CHANGES (Î”x, Î”y), not absolute positions                   â”‚
â”‚      Final position = Current position + Î£(all predicted changes)              â”‚
â”‚                                                                                  â”‚
â”‚      Frame 1: xâ‚ = xâ‚€ + Î”xâ‚                                                    â”‚
â”‚      Frame 2: xâ‚‚ = xâ‚€ + Î”xâ‚ + Î”xâ‚‚                                              â”‚
â”‚      Frame 3: xâ‚ƒ = xâ‚€ + Î”xâ‚ + Î”xâ‚‚ + Î”xâ‚ƒ                                        â”‚
â”‚      ... and so on                                                              â”‚
â”‚                                                                                  â”‚
â”‚   2. BOUNDARY CLIPPING                                                          â”‚
â”‚      Players can't go outside the field!                                       â”‚
â”‚      x = clip(x, 0, 120)  # Keep within 0-120 yards                           â”‚
â”‚      y = clip(y, 0, 53.3) # Keep within 0-53.3 yards                          â”‚
â”‚                                                                                  â”‚
â”‚   3. DIRECTION RESTORATION                                                      â”‚
â”‚      Remember we flipped some plays? Now we flip them back!                    â”‚
â”‚      if original_direction == 'left':                                          â”‚
â”‚          x = 120 - x                                                           â”‚
â”‚          y = 53.3 - y                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸ“¤ STAGE 8: OUTPUT                                      â”‚
â”‚                                                                                  â”‚
â”‚   Final output: CSV file with predictions                                       â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”‚ game_id â”‚ play_id â”‚ nfl_id â”‚ frame_id â”‚   x    â”‚   y    â”‚                  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
â”‚   â”‚ 2023001 â”‚   123   â”‚  45678 â”‚    1     â”‚  34.21 â”‚  22.45 â”‚                  â”‚
â”‚   â”‚ 2023001 â”‚   123   â”‚  45678 â”‚    2     â”‚  35.67 â”‚  23.12 â”‚                  â”‚
â”‚   â”‚ 2023001 â”‚   123   â”‚  45678 â”‚    3     â”‚  37.23 â”‚  23.89 â”‚                  â”‚
â”‚   â”‚   ...   â”‚   ...   â”‚  ...   â”‚   ...    â”‚  ...   â”‚  ...   â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                                  â”‚
â”‚   Evaluated using RMSE (Root Mean Square Error):                               â”‚
â”‚   RMSE = âˆš[Î£(predicted - actual)Â² / n]                                         â”‚
â”‚   Lower is better! Top teams achieve ~0.49 RMSE                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ“Š Understanding the Data

## What Does the Tracking Data Look Like?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            ğŸˆ THE FOOTBALL FIELD                                 â”‚
â”‚                                                                                  â”‚
â”‚    0 yards                                                          120 yards   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚    â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚                                              â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚  â”‚       â”‚
â”‚    â”‚â–‘ END  â–‘â”‚                      50                      â”‚â–‘ END  â–‘â”‚  â”‚       â”‚
â”‚    â”‚â–‘ ZONE â–‘â”‚    ğŸƒâ†P1                                     â”‚â–‘ ZONE â–‘â”‚  â”‚ 53.3  â”‚
â”‚    â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚                   ğŸƒâ†P2     ğŸˆâ†Ball          â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚  â”‚ yards â”‚
â”‚    â”‚        â”‚         ğŸƒâ†P3              lands here        â”‚        â”‚  â”‚       â”‚
â”‚    â”‚        â”‚                     ğŸƒâ†P4                    â”‚        â”‚  â”‚       â”‚
â”‚    â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚              ğŸƒâ†P5                           â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚  â”‚       â”‚
â”‚    â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚                                              â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚  â”‚       â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚    0 yards                                                          53.3 yards  â”‚
â”‚                                                                                  â”‚
â”‚    Coordinate System:                                                           â”‚
â”‚    â€¢ x-axis: Length of field (0 to 120 yards, including end zones)             â”‚
â”‚    â€¢ y-axis: Width of field (0 to 53.3 yards)                                  â”‚
â”‚    â€¢ Origin (0,0): Bottom-left corner                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Sample Data Row Explained

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EXAMPLE: One row of tracking data                                              â”‚
â”‚                                                                                  â”‚
â”‚  game_id: 2023091000        â† Unique game identifier (includes date)           â”‚
â”‚  play_id: 64                â† Which play in the game                           â”‚
â”‚  nfl_id: 47956              â† Unique player ID                                 â”‚
â”‚  frame_id: 15               â† Which snapshot (10 per second)                   â”‚
â”‚                                                                                  â”‚
â”‚  x: 45.23                   â† Position along field length (yards)              â”‚
â”‚  y: 26.78                   â† Position along field width (yards)               â”‚
â”‚  s: 7.34                    â† Speed (yards per second)                         â”‚
â”‚  a: 2.15                    â† Acceleration (yards per secondÂ²)                 â”‚
â”‚  o: 125.4                   â† Body orientation (degrees, 0-360)                â”‚
â”‚  dir: 118.7                 â† Movement direction (degrees, 0-360)              â”‚
â”‚                                                                                  â”‚
â”‚  player_role: "Targeted Receiver"  â† What this player is doing                 â”‚
â”‚  player_side: "Offense"            â† Which team                                â”‚
â”‚  ball_land_x: 52.10                â† Where the ball will land                  â”‚
â”‚  ball_land_y: 24.33                                                            â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Visual: Direction vs Orientation                       â”‚                   â”‚
â”‚  â”‚                                                         â”‚                   â”‚
â”‚  â”‚        dir=118.7Â° (moving this way)                    â”‚                   â”‚
â”‚  â”‚              â†—                                          â”‚                   â”‚
â”‚  â”‚             /                                           â”‚                   â”‚
â”‚  â”‚     o=125.4Â° ğŸƒ (body facing this way)                  â”‚                   â”‚
â”‚  â”‚              â†–                                          â”‚                   â”‚
â”‚  â”‚                                                         â”‚                   â”‚
â”‚  â”‚  Note: Players often face differently than they move!  â”‚                   â”‚
â”‚  â”‚  (Like running while looking back for the ball)        â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ”§ Model 1: CumsumModel

## Architecture Overview

The CumsumModel combines three powerful techniques: **Convolutions** (pattern detection), **GRU** (memory), and **Attention** (focus on what matters).

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          CumsumModel ARCHITECTURE                                 â•‘
â•‘                    (Convolutional + GRU + Attention Hybrid)                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INPUT: Sequence of player states over time
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                  â”‚
â”‚   Shape: (batch_size, window=20, features=198)                                  â”‚
â”‚                                                                                  â”‚
â”‚   Example for ONE player:                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ Time   â”‚ x    â”‚ y    â”‚ speed â”‚ ... â”‚ dist_ball â”‚ is_receiver â”‚  â”‚          â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚          â”‚
â”‚   â”‚ t-19   â”‚ 32.1 â”‚ 15.2 â”‚  5.2  â”‚ ... â”‚   18.4    â”‚     1       â”‚  â”‚          â”‚
â”‚   â”‚ t-18   â”‚ 32.8 â”‚ 15.9 â”‚  5.8  â”‚ ... â”‚   17.1    â”‚     1       â”‚  â”‚          â”‚
â”‚   â”‚  ...   â”‚ ...  â”‚ ...  â”‚  ...  â”‚ ... â”‚   ...     â”‚    ...      â”‚  â”‚          â”‚
â”‚   â”‚ t-1    â”‚ 38.2 â”‚ 20.1 â”‚  7.1  â”‚ ... â”‚   11.2    â”‚     1       â”‚  â”‚          â”‚
â”‚   â”‚ t=0    â”‚ 39.1 â”‚ 21.0 â”‚  7.3  â”‚ ... â”‚   10.0    â”‚     1       â”‚  â”‚  â† NOW  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: LINEAR PROJECTION (Dimensionality Reduction)                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                           â”‚
â”‚                                                                                  â”‚
â”‚  Why? 198 features is a lot! We compress to 64 dimensions.                     â”‚
â”‚  Think of it as: Finding the 64 most important "combinations" of features      â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚  198 features   â”‚  â”€â”€â”€â”€â–º  â”‚   64 features   â”‚                               â”‚
â”‚  â”‚  per timestep   â”‚  Linear â”‚   per timestep  â”‚                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 20, 198) â†’ (batch, 20, 64)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: CAUSAL CONVOLUTION STACK (Pattern Detection)                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                           â”‚
â”‚                                                                                  â”‚
â”‚  What are convolutions? They're like sliding windows that detect patterns!     â”‚
â”‚                                                                                  â”‚
â”‚  Example: A conv filter might learn to detect "player accelerating"            â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Input: â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                     â”‚          â”‚
â”‚  â”‚          [t-19][t-18][t-17]...[t-2][t-1][t-0]                    â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Conv1D (kernel=3):                                             â”‚          â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”                                                    â”‚          â”‚
â”‚  â”‚          â”‚ â–“ â”‚ â† Filter slides across time                       â”‚          â”‚
â”‚  â”‚          â””â”€â”€â”€â”˜                                                    â”‚          â”‚
â”‚  â”‚            â†“                                                      â”‚          â”‚
â”‚  â”‚   Detects: [acceleration patterns] [turning] [slowing down]      â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  Layer 1: Conv1D(64 â†’ 128, kernel=3) + ReLU                                    â”‚
â”‚  Layer 2: Conv1D(128 â†’ 256, kernel=3) + ReLU                                   â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 20, 64) â†’ (batch, 22, 128) â†’ (batch, 24, 256)                  â”‚
â”‚         (padding adds extra timesteps)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: LAYER NORMALIZATION (Stabilization)                                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                   â”‚
â”‚                                                                                  â”‚
â”‚  Normalizes values to prevent extreme numbers                                   â”‚
â”‚  Makes training more stable                                                     â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 24, 256) â†’ (batch, 24, 256) [values normalized]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: MULTI-HEAD ATTENTION (Focus Mechanism)                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                â”‚
â”‚                                                                                  â”‚
â”‚  ATTENTION answers: "Which past moments are MOST RELEVANT for prediction?"     â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Q: "I need to predict where player goes next"                  â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   K: Keys (what each timestep "contains")                        â”‚          â”‚
â”‚  â”‚       [t-19: slow] [t-18: slow] [t-10: turning] [t-0: fast]     â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   V: Values (the actual information)                             â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Attention weights:                                              â”‚          â”‚
â”‚  â”‚       [t-19: 0.02] [t-18: 0.02] [t-10: 0.15] [t-0: 0.45] ...   â”‚          â”‚
â”‚  â”‚            â†‘             â†‘            â†‘           â†‘              â”‚          â”‚
â”‚  â”‚         ignore        ignore      important   VERY important     â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  4 attention heads = 4 different "perspectives" on what's important            â”‚
â”‚                                                                                  â”‚
â”‚  Residual connection: output = input + attention(input)                        â”‚
â”‚  (Keeps original information while adding attention insights)                  â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 24, 256) â†’ (batch, 24, 256)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 5: GRU LAYERS (Memory)                                                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                   â”‚
â”‚                                                                                  â”‚
â”‚  GRU = Gated Recurrent Unit (a type of recurrent neural network)               â”‚
â”‚  It processes the sequence step-by-step, maintaining a "memory"                â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Processing order:                                               â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   [t-19] â†’ GRU â†’ hiddenâ‚                                         â”‚          â”‚
â”‚  â”‚              â†“                                                    â”‚          â”‚
â”‚  â”‚   [t-18] â†’ GRU â†’ hiddenâ‚‚ (remembers t-19!)                       â”‚          â”‚
â”‚  â”‚              â†“                                                    â”‚          â”‚
â”‚  â”‚   [t-17] â†’ GRU â†’ hiddenâ‚ƒ (remembers t-19, t-18!)                â”‚          â”‚
â”‚  â”‚              â†“                                                    â”‚          â”‚
â”‚  â”‚           ...                                                     â”‚          â”‚
â”‚  â”‚              â†“                                                    â”‚          â”‚
â”‚  â”‚   [t=0]  â†’ GRU â†’ hidden_final (remembers EVERYTHING relevant!)   â”‚          â”‚
â”‚  â”‚                      â†“                                            â”‚          â”‚
â”‚  â”‚              This is our context vector!                         â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  2 GRU layers stacked (deeper = more complex patterns)                         â”‚
â”‚  hidden_dim = 256                                                              â”‚
â”‚  dropout = 0.1 (randomly zero out 10% to prevent overfitting)                  â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 24, 256) â†’ take last hidden â†’ (batch, 256)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 6: DECODER (Prediction Head)                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚
â”‚                                                                                  â”‚
â”‚  Takes the 256-dim context and predicts 94Ã—2 = 188 values                      â”‚
â”‚  (94 future frames Ã— 2 coordinates per frame)                                  â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚   Context Vector    â”‚         â”‚    Predictions      â”‚                       â”‚
â”‚  â”‚      (256)          â”‚  â”€â”€â”€â”€â–º  â”‚   (94, 2)           â”‚                       â”‚
â”‚  â”‚                     â”‚  Linear â”‚                     â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                                  â”‚
â”‚  Output: Î”x, Î”y for each of 94 future frames                                   â”‚
â”‚  (These are CHANGES, not absolute positions!)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 7: CUMULATIVE SUM (The "Cumsum" in CumsumModel)                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                          â”‚
â”‚                                                                                  â”‚
â”‚  Why predict deltas instead of absolute positions?                             â”‚
â”‚  â†’ Easier to learn! Small changes are more consistent than absolute coords.    â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Model predicts: [Î”â‚, Î”â‚‚, Î”â‚ƒ, Î”â‚„, ... Î”â‚‰â‚„]                     â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Cumsum converts to positions:                                  â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Positionâ‚ = xâ‚€ + Î”â‚                                            â”‚          â”‚
â”‚  â”‚   Positionâ‚‚ = xâ‚€ + Î”â‚ + Î”â‚‚                                       â”‚          â”‚
â”‚  â”‚   Positionâ‚ƒ = xâ‚€ + Î”â‚ + Î”â‚‚ + Î”â‚ƒ                                  â”‚          â”‚
â”‚  â”‚   ...                                                             â”‚          â”‚
â”‚  â”‚   Positionâ‚‰â‚„ = xâ‚€ + Î£(all deltas)                                â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   This creates SMOOTH trajectories! No jumping around.           â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  Final Shape: (batch, 94, 2) â†’ 94 (x,y) positions for each sample             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

OUTPUT: Predicted trajectory
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                  â”‚
â”‚   Frame 1:  (40.2, 22.1)   â†  xâ‚€ + Î”xâ‚, yâ‚€ + Î”yâ‚                              â”‚
â”‚   Frame 2:  (41.5, 23.4)                                                        â”‚
â”‚   Frame 3:  (42.9, 24.8)                                                        â”‚
â”‚   ...                                                                            â”‚
â”‚   Frame 94: (52.1, 24.3)   â†  Player arrives at ball!                          â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ”§ Model 2: GRU + Attention (SeqModel)

## Architecture Overview

This model uses a clever trick: **Multiple Query Attention Pooling**. Instead of just using the last hidden state, it asks multiple "questions" about the sequence.

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     GRU + ATTENTION (SeqModel) ARCHITECTURE                       â•‘
â•‘                    Bidirectional GRU with Multi-Query Pooling                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INPUT: Normalized feature sequence
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Shape: (batch_size, window=12, features=167)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: BIDIRECTIONAL GRU (Processing from Both Directions)                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                   â”‚
â”‚                                                                                  â”‚
â”‚  Unlike regular GRU (leftâ†’right only), Bidirectional reads BOTH ways!          â”‚
â”‚                                                                                  â”‚
â”‚  Why? Sometimes future context helps understand the past!                       â”‚
â”‚  Example: A player's deceleration makes more sense when you see they're about  â”‚
â”‚           to make a cut.                                                        â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Forward GRU:  [t-11] â†’ [t-10] â†’ [t-9] â†’ ... â†’ [t-1] â†’ [t=0]   â”‚          â”‚
â”‚  â”‚                    â†’       â†’       â†’              â†’       â†’      â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Backward GRU: [t-11] â† [t-10] â† [t-9] â† ... â† [t-1] â† [t=0]   â”‚          â”‚
â”‚  â”‚                    â†       â†       â†              â†       â†      â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Combined: [forward_hidden âŠ• backward_hidden] at each timestep  â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  Parameters:                                                                     â”‚
â”‚  â€¢ input_dim = 167 features                                                     â”‚
â”‚  â€¢ hidden_dim = 128                                                             â”‚
â”‚  â€¢ num_layers = 2 (stacked GRUs)                                               â”‚
â”‚  â€¢ bidirectional = True â†’ output_dim = 128 Ã— 2 = 256                           â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 12, 167) â†’ (batch, 12, 256)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: RESIDUAL CONNECTION (Skip Connection)                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                 â”‚
â”‚                                                                                  â”‚
â”‚  Problem: Deep networks can "forget" the original input                        â”‚
â”‚  Solution: Add a shortcut that preserves original information                  â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Original Input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚          â”‚
â”‚  â”‚        â”‚                                      â”‚                  â”‚          â”‚
â”‚  â”‚        â–¼                                      â”‚                  â”‚          â”‚
â”‚  â”‚      [GRU]                                    â”‚                  â”‚          â”‚
â”‚  â”‚        â”‚                                      â”‚ Linear           â”‚          â”‚
â”‚  â”‚        â–¼                                      â”‚ Projection       â”‚          â”‚
â”‚  â”‚   GRU Output                                  â”‚                  â”‚          â”‚
â”‚  â”‚        â”‚                                      â”‚                  â”‚          â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ + â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚          â”‚
â”‚  â”‚                      â”‚                                           â”‚          â”‚
â”‚  â”‚                      â–¼                                           â”‚          â”‚
â”‚  â”‚              Enhanced Output                                     â”‚          â”‚
â”‚  â”‚        (GRU patterns + Original features)                       â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  h = GRU(x) + Linear(x)  â† Residual addition                                   â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 12, 256) + (batch, 12, 256) = (batch, 12, 256)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: MULTI-QUERY ATTENTION POOLING (The Key Innovation!)                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                   â”‚
â”‚                                                                                  â”‚
â”‚  Problem: We have 12 timesteps but need ONE context vector.                    â”‚
â”‚  Simple solution: Just use the last timestep.                                  â”‚
â”‚  Better solution: Learn to ASK QUESTIONS and aggregate answers!                â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   LEARNABLE QUERIES (n_queries = 2)                              â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Query 1: "What's the overall movement trend?"                  â”‚          â”‚
â”‚  â”‚            â†’ Might focus on: [t-5], [t-3], [t-1]                â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Query 2: "What's the most recent state?"                       â”‚          â”‚
â”‚  â”‚            â†’ Might focus on: [t-2], [t-1], [t=0]                â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚          â”‚
â”‚  â”‚   â”‚   Sequence:  [hâ‚€][hâ‚][hâ‚‚][hâ‚ƒ][hâ‚„]...[hâ‚â‚€][hâ‚â‚]     â”‚        â”‚          â”‚
â”‚  â”‚   â”‚                                                      â”‚        â”‚          â”‚
â”‚  â”‚   â”‚   Query 1:    0.1 0.05 0.1 0.15 0.2 ... 0.1  0.2    â”‚        â”‚          â”‚
â”‚  â”‚   â”‚   Query 2:    0.02 0.02 0.02 0.02 0.02 ... 0.3  0.6  â”‚        â”‚          â”‚
â”‚  â”‚   â”‚                                        (weights sum to 1)    â”‚          â”‚
â”‚  â”‚   â”‚                                                      â”‚        â”‚          â”‚
â”‚  â”‚   â”‚   Contextâ‚ = Î£(weight Ã— hidden) for Query 1         â”‚        â”‚          â”‚
â”‚  â”‚   â”‚   Contextâ‚‚ = Î£(weight Ã— hidden) for Query 2         â”‚        â”‚          â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Final context = [Contextâ‚ âŠ• Contextâ‚‚]  (concatenated)         â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  Attention mechanism:                                                           â”‚
â”‚  â€¢ Q = learnable query vectors (2 queries Ã— 256 dim)                           â”‚
â”‚  â€¢ K = LayerNorm(GRU_output)                                                   â”‚
â”‚  â€¢ V = LayerNorm(GRU_output)                                                   â”‚
â”‚  â€¢ 4 attention heads (different perspectives)                                  â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 12, 256) â†’ attention â†’ (batch, 2, 256) â†’ flatten â†’ (batch, 512)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: RESIDUAL MLP HEAD (Prediction with Skip Connections)                   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                     â”‚
â”‚                                                                                  â”‚
â”‚  A Multi-Layer Perceptron with residual connections for stability              â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Input: 512-dim context                                         â”‚          â”‚
â”‚  â”‚      â”‚                                                            â”‚          â”‚
â”‚  â”‚      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚          â”‚
â”‚  â”‚      â”‚                                     â”‚                     â”‚          â”‚
â”‚  â”‚      â–¼                                     â”‚                     â”‚          â”‚
â”‚  â”‚   Linear(512 â†’ 128)                        â”‚                     â”‚          â”‚
â”‚  â”‚      â”‚                                     â”‚                     â”‚          â”‚
â”‚  â”‚      â–¼                                     â”‚                     â”‚          â”‚
â”‚  â”‚    GELU (activation)                       â”‚                     â”‚          â”‚
â”‚  â”‚      â”‚                                     â”‚                     â”‚          â”‚
â”‚  â”‚      â–¼                                     â”‚                     â”‚          â”‚
â”‚  â”‚   Dropout(0.2)                             â”‚ Linear(512 â†’ 128)   â”‚          â”‚
â”‚  â”‚      â”‚                                     â”‚ (skip projection)   â”‚          â”‚
â”‚  â”‚      â–¼                                     â”‚                     â”‚          â”‚
â”‚  â”‚   Linear(128 â†’ 128)                        â”‚                     â”‚          â”‚
â”‚  â”‚      â”‚                                     â”‚                     â”‚          â”‚
â”‚  â”‚      â–¼                                     â”‚                     â”‚          â”‚
â”‚  â”‚    GELU                                    â”‚                     â”‚          â”‚
â”‚  â”‚      â”‚                                     â”‚                     â”‚          â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ + â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚          â”‚
â”‚  â”‚                    â”‚                                              â”‚          â”‚
â”‚  â”‚                    â–¼                                              â”‚          â”‚
â”‚  â”‚            Linear(128 â†’ 94)                                      â”‚          â”‚
â”‚  â”‚                    â”‚                                              â”‚          â”‚
â”‚  â”‚                    â–¼                                              â”‚          â”‚
â”‚  â”‚              Output (94 values)                                  â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  Note: This model predicts X and Y SEPARATELY!                                 â”‚
â”‚  Two models: one for Î”x, one for Î”y                                            â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 512) â†’ (batch, 94)                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 5: CUMULATIVE SUM                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                        â”‚
â”‚                                                                                  â”‚
â”‚  output = cumsum(predicted_deltas)                                             â”‚
â”‚                                                                                  â”‚
â”‚  Converts: [Î”â‚, Î”â‚‚, Î”â‚ƒ, ...] â†’ [Î”â‚, Î”â‚+Î”â‚‚, Î”â‚+Î”â‚‚+Î”â‚ƒ, ...]                    â”‚
â”‚                                                                                  â”‚
â”‚  Final Shape: (batch, 94) for each of x and y                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ”§ Model 3: GNN-Enhanced Transformer

## Architecture Overview

This model adds **Graph Neural Network-style** features that capture relationships between ALL players on the field, not just individual trajectories.

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    GNN-ENHANCED TRANSFORMER ARCHITECTURE                          â•‘
â•‘                  Graph Features + Spatio-Temporal Transformer                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

UNIQUE FEATURE: GNN NEIGHBOR EMBEDDINGS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                  â”‚
â”‚  The Key Insight: Football is a TEAM sport!                                     â”‚
â”‚  A player's movement depends on WHERE OTHER PLAYERS ARE.                        â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   ğŸŸ¢ = Allies (same team)                                        â”‚          â”‚
â”‚  â”‚   ğŸ”´ = Opponents (other team)                                    â”‚          â”‚
â”‚  â”‚   ğŸ¯ = Target player (who we're predicting for)                  â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚                  ğŸŸ¢â‚ (ally)                                       â”‚          â”‚
â”‚  â”‚                   â”‚                                               â”‚          â”‚
â”‚  â”‚          ğŸ”´â‚ â”€â”€â”€â”€ ğŸ¯ â”€â”€â”€â”€ ğŸŸ¢â‚‚                                    â”‚          â”‚
â”‚  â”‚         (opp)     â”‚     (ally)                                   â”‚          â”‚
â”‚  â”‚                   â”‚                                               â”‚          â”‚
â”‚  â”‚          ğŸ”´â‚‚ â”€â”€â”€â”€ â”´ â”€â”€â”€â”€ ğŸ”´â‚ƒ                                     â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   For each player, we compute:                                   â”‚          â”‚
â”‚  â”‚   â€¢ Distance to nearest opponent                                 â”‚          â”‚
â”‚  â”‚   â€¢ Average position of nearby allies                            â”‚          â”‚
â”‚  â”‚   â€¢ Relative velocities of neighbors                             â”‚          â”‚
â”‚  â”‚   â€¢ "Pressure" from defenders                                    â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

GNN FEATURE COMPUTATION (Pre-processing step)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                  â”‚
â”‚  STEP 1: Find Neighbors                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚                                                                                  â”‚
â”‚  For each player:                                                               â”‚
â”‚  â€¢ Find K=6 nearest other players                                              â”‚
â”‚  â€¢ Only consider players within radius=30 yards                                â”‚
â”‚                                                                                  â”‚
â”‚  STEP 2: Compute Weights                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚                                                                                  â”‚
â”‚  Closer players matter more! Use exponential decay:                            â”‚
â”‚                                                                                  â”‚
â”‚     weight = exp(-distance / Ï„)    where Ï„ = 8.0                               â”‚
â”‚                                                                                  â”‚
â”‚     Distance:  1 yd  â†’  weight = 0.88  (very important)                        â”‚
â”‚     Distance: 10 yds â†’  weight = 0.29  (somewhat important)                    â”‚
â”‚     Distance: 25 yds â†’  weight = 0.04  (barely matters)                        â”‚
â”‚                                                                                  â”‚
â”‚  STEP 3: Aggregate Features (Separately for Allies and Opponents)              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚                                                              â”‚               â”‚
â”‚  â”‚  ALLY FEATURES (ğŸŸ¢):                                         â”‚               â”‚
â”‚  â”‚  â€¢ gnn_ally_dx_mean:  Weighted avg X-distance to allies     â”‚               â”‚
â”‚  â”‚  â€¢ gnn_ally_dy_mean:  Weighted avg Y-distance to allies     â”‚               â”‚
â”‚  â”‚  â€¢ gnn_ally_dvx_mean: Weighted avg X-velocity difference    â”‚               â”‚
â”‚  â”‚  â€¢ gnn_ally_dvy_mean: Weighted avg Y-velocity difference    â”‚               â”‚
â”‚  â”‚  â€¢ gnn_ally_cnt:      Number of allies nearby               â”‚               â”‚
â”‚  â”‚  â€¢ gnn_ally_dmin:     Distance to nearest ally              â”‚               â”‚
â”‚  â”‚  â€¢ gnn_ally_dmean:    Average distance to allies            â”‚               â”‚
â”‚  â”‚                                                              â”‚               â”‚
â”‚  â”‚  OPPONENT FEATURES (ğŸ”´):                                     â”‚               â”‚
â”‚  â”‚  â€¢ gnn_opp_dx_mean:   Weighted avg X-distance to opponents  â”‚               â”‚
â”‚  â”‚  â€¢ gnn_opp_dy_mean:   Weighted avg Y-distance to opponents  â”‚               â”‚
â”‚  â”‚  â€¢ gnn_opp_dvx_mean:  Weighted avg X-velocity difference    â”‚               â”‚
â”‚  â”‚  â€¢ gnn_opp_dvy_mean:  Weighted avg Y-velocity difference    â”‚               â”‚
â”‚  â”‚  â€¢ gnn_opp_cnt:       Number of opponents nearby            â”‚               â”‚
â”‚  â”‚  â€¢ gnn_opp_dmin:      Distance to nearest opponent          â”‚               â”‚
â”‚  â”‚  â€¢ gnn_opp_dmean:     Average distance to opponents         â”‚               â”‚
â”‚  â”‚                                                              â”‚               â”‚
â”‚  â”‚  GENERAL:                                                    â”‚               â”‚
â”‚  â”‚  â€¢ gnn_d1, gnn_d2, gnn_d3: Distances to 1st, 2nd, 3rd       â”‚               â”‚
â”‚  â”‚                             nearest players                  â”‚               â”‚
â”‚  â”‚                                                              â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                                  â”‚
â”‚  Total: 17 GNN features added to each player's feature vector                  â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

GEOMETRIC BASELINE FEATURES (Another Pre-processing Innovation)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                  â”‚
â”‚  The Insight: Players have PREDICTABLE destinations based on their role!       â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚  RECEIVER â†’ Should end up at BALL LANDING LOCATION               â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚     Current position: (30, 20)                                   â”‚          â”‚
â”‚  â”‚     Ball lands at:    (50, 25)                                   â”‚          â”‚
â”‚  â”‚     Geometric endpoint: (50, 25) â† Go to ball!                   â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚  DEFENDER â†’ Should MIRROR the receiver they're covering          â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚     Current offset from receiver: (2, -1)                        â”‚          â”‚
â”‚  â”‚     Ball lands at: (50, 25)                                      â”‚          â”‚
â”‚  â”‚     Geometric endpoint: (52, 24) â† Stay on receiver!             â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚  OTHERS â†’ Follow momentum (physics)                              â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚     Current position: (40, 30)                                   â”‚          â”‚
â”‚  â”‚     Current velocity: (2, -0.5)                                  â”‚          â”‚
â”‚  â”‚     Time until ball lands: 2.5 seconds                           â”‚          â”‚
â”‚  â”‚     Geometric endpoint: (45, 28.75) â† Just keep going!           â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  Geometric Features Computed:                                                   â”‚
â”‚  â€¢ geo_endpoint_x, geo_endpoint_y:  Where player "should" end up              â”‚
â”‚  â€¢ geo_vector_x, geo_vector_y:      Direction to geometric endpoint            â”‚
â”‚  â€¢ geo_distance:                    How far to geometric endpoint              â”‚
â”‚  â€¢ geo_required_vx, geo_required_vy: Velocity needed to reach endpoint        â”‚
â”‚  â€¢ geo_velocity_error_x/y:          Current vs required velocity               â”‚
â”‚  â€¢ geo_alignment:                   Is player heading toward endpoint?         â”‚
â”‚                                                                                  â”‚
â”‚  Total: 13 geometric features                                                  â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TRANSFORMER ARCHITECTURE (After GNN Features Added)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                  â”‚
â”‚  INPUT: (batch, window=10, features=167)                                        â”‚
â”‚         154 base features + 13 geometric features + various GNN features        â”‚
â”‚                                                                                  â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  LINEAR PROJECTION                                               â”‚           â”‚
â”‚  â”‚  167 features â†’ 128 hidden dimensions                           â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  + POSITIONAL ENCODING                                          â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  Each timestep gets a unique "position signature"               â”‚           â”‚
â”‚  â”‚  So the model knows: this is frame -10, this is frame -9, etc. â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  pos_embed = learnable parameter (1, window_size, hidden_dim)   â”‚           â”‚
â”‚  â”‚  output = input_projection + pos_embed                          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  TRANSFORMER ENCODER (2 layers)                                  â”‚           â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                 â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  Each layer contains:                                           â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚           â”‚
â”‚  â”‚  â”‚  Multi-Head Self-Attention (4 heads)                    â”‚    â”‚           â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚           â”‚
â”‚  â”‚  â”‚  "Let each timestep attend to all other timesteps"      â”‚    â”‚           â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚           â”‚
â”‚  â”‚  â”‚  Frame t=0 asks: "Which past frames help predict me?"   â”‚    â”‚           â”‚
â”‚  â”‚  â”‚    â†’ Learns: "Frame t-1 and t-3 are most relevant"      â”‚    â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚           â”‚
â”‚  â”‚                          â”‚                                       â”‚           â”‚
â”‚  â”‚                          â–¼                                       â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚           â”‚
â”‚  â”‚  â”‚  Feed-Forward Network (FFN)                             â”‚    â”‚           â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚           â”‚
â”‚  â”‚  â”‚  Linear(128 â†’ 512) â†’ GELU â†’ Linear(512 â†’ 128)           â”‚    â”‚           â”‚
â”‚  â”‚  â”‚                                                          â”‚    â”‚           â”‚
â”‚  â”‚  â”‚  Processes each position independently                  â”‚    â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  + Residual connections and LayerNorm after each sub-layer     â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  ATTENTION POOLING (Learned Query)                              â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  Similar to SeqModel, but with single query                     â”‚           â”‚
â”‚  â”‚  Compresses (batch, 10, 128) â†’ (batch, 128)                    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  RESIDUAL MLP HEAD                                              â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  2 residual blocks, each:                                       â”‚           â”‚
â”‚  â”‚  â€¢ Linear â†’ GELU â†’ Dropout â†’ Linear â†’ + skip                   â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  Final: Linear(128 â†’ 94Ã—2) = 188 outputs                       â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                        â”‚                                        â”‚
â”‚                                        â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  RESHAPE + CUMULATIVE SUM                                       â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  (batch, 188) â†’ reshape â†’ (batch, 94, 2) â†’ cumsum â†’ positions  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ”§ Model 4: Spatio-Temporal Transformer

## Architecture Overview

This is a more sophisticated transformer variant with deeper architecture and enhanced normalization.

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    SPATIO-TEMPORAL TRANSFORMER ARCHITECTURE                       â•‘
â•‘                     Deep Transformer with Pre-LayerNorm                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INPUT: (batch_size, window=12, features=198)
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INPUT PROJECTION                                                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                             â”‚
â”‚                                                                                  â”‚
â”‚  Linear(198 â†’ 256)                                                              â”‚
â”‚                                                                                  â”‚
â”‚  Expands feature space for richer representations                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEMPORAL POSITIONAL ENCODING                                                   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                   â”‚
â”‚                                                                                  â”‚
â”‚  Learnable position embeddings for each of 12 timesteps                        â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (1, 12, 256) - broadcasts across batch                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TRANSFORMER ENCODER (4 Layers, 8 Heads)                                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                       â”‚
â”‚                                                                                  â”‚
â”‚  Key difference: Pre-LayerNorm (more stable training)                          â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Standard (Post-LN):    x â†’ Attention â†’ Add â†’ LN               â”‚          â”‚
â”‚  â”‚   This model (Pre-LN):   x â†’ LN â†’ Attention â†’ Add               â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â”‚   Pre-LN is more stable for deep networks!                       â”‚          â”‚
â”‚  â”‚                                                                   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                                  â”‚
â”‚  For each of 4 layers:                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚           â”‚
â”‚  â”‚  â”‚   LayerNorm   â”‚                                              â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚           â”‚
â”‚  â”‚          â–¼                                                       â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚           â”‚
â”‚  â”‚  â”‚  Multi-Head   â”‚  8 attention heads                           â”‚           â”‚
â”‚  â”‚  â”‚  Attention    â”‚  Each head learns different patterns         â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚           â”‚
â”‚  â”‚          â”‚                                                       â”‚           â”‚
â”‚  â”‚          + â†â”€â”€â”€â”€â”€â”€â”€â”€â”€ (residual from before LayerNorm)          â”‚           â”‚
â”‚  â”‚          â”‚                                                       â”‚           â”‚
â”‚  â”‚          â–¼                                                       â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚           â”‚
â”‚  â”‚  â”‚   LayerNorm   â”‚                                              â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚           â”‚
â”‚  â”‚          â–¼                                                       â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚           â”‚
â”‚  â”‚  â”‚      FFN      â”‚  256 â†’ 1024 â†’ 256                            â”‚           â”‚
â”‚  â”‚  â”‚  (feed-fwd)   â”‚                                              â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚           â”‚
â”‚  â”‚          â”‚                                                       â”‚           â”‚
â”‚  â”‚          + â†â”€â”€â”€â”€â”€â”€â”€â”€â”€ (residual)                                â”‚           â”‚
â”‚  â”‚          â”‚                                                       â”‚           â”‚
â”‚  â”‚          â–¼                                                       â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                                  â”‚
â”‚  Shape throughout: (batch, 12, 256)                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SOFTMAX ATTENTION POOLING                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                     â”‚
â”‚                                                                                  â”‚
â”‚  Different from learned-query pooling!                                         â”‚
â”‚                                                                                  â”‚
â”‚  weights = softmax(mean(transformer_output, dim=-1))                           â”‚
â”‚  pooled = sum(weights Ã— transformer_output)                                    â”‚
â”‚                                                                                  â”‚
â”‚  This weights each timestep by its "average activation"                        â”‚
â”‚  High activations = more important timesteps                                   â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 12, 256) â†’ (batch, 256)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RESIDUAL MLP PREDICTION HEAD                                                   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                   â”‚
â”‚                                                                                  â”‚
â”‚  3 layers with residual connections:                                           â”‚
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  Linear(256 â†’ 512) â†’ LayerNorm â†’ GELU â†’ Dropout(0.1)           â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  [Residual Block 1]                                             â”‚           â”‚
â”‚  â”‚  Linear(512 â†’ 512) â†’ LayerNorm â†’ GELU â†’ Dropout + skip         â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  [Residual Block 2]                                             â”‚           â”‚
â”‚  â”‚  Linear(512 â†’ 512) â†’ LayerNorm â†’ GELU â†’ Dropout + skip         â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â”‚  Linear(512 â†’ 94)                                               â”‚           â”‚
â”‚  â”‚                                                                  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                                  â”‚
â”‚  Output LayerNorm for stability                                                â”‚
â”‚                                                                                  â”‚
â”‚  Shape: (batch, 256) â†’ (batch, 94)                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CUMULATIVE SUM                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                                â”‚
â”‚                                                                                  â”‚
â”‚  cumsum(predictions) along time dimension                                      â”‚
â”‚                                                                                  â”‚
â”‚  Output: (batch, 94) displacement values                                       â”‚
â”‚          Add to last known position to get absolute coordinates                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ¯ The Final Ensemble

## How All Models Work Together

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         FINAL ENSEMBLE ARCHITECTURE                               â•‘
â•‘                      6 Models Combined for Best Prediction                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  Test Input     â”‚
                              â”‚  (per play)     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚           FEATURE ENGINEERING                   â”‚
              â”‚     (Different pipelines for different models) â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                            â”‚                            â”‚
          â–¼                            â–¼                            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Pipeline A  â”‚            â”‚  Pipeline B  â”‚            â”‚  Pipeline C  â”‚
   â”‚  198 featuresâ”‚            â”‚  167 featuresâ”‚            â”‚  167 featuresâ”‚
   â”‚  window=20   â”‚            â”‚  window=12   â”‚            â”‚  window=10   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                           â”‚                           â”‚
          â–¼                           â–¼                           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ CumsumModel  â”‚            â”‚  Open Source â”‚            â”‚   GNN+Trans  â”‚
   â”‚ (Custom)     â”‚            â”‚   Models     â”‚            â”‚   (Custom)   â”‚
   â”‚              â”‚            â”‚              â”‚            â”‚              â”‚
   â”‚ Conv+GRU+Attnâ”‚            â”‚ 5 variants   â”‚            â”‚ Graph+Trans  â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                           â”‚                           â”‚
          â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                    â”‚
          â”‚                    â”‚             â”‚                    â”‚
          â”‚              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”              â”‚
          â”‚              â”‚           â”‚ â”‚           â”‚              â”‚
          â–¼              â–¼           â–¼ â–¼           â–¼              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                     â”‚
   â”‚                        MODEL PREDICTIONS                            â”‚
   â”‚                                                                     â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
   â”‚  â”‚ CumsumModel â”‚ â”‚   nfl_gru   â”‚ â”‚  nfl_gru3   â”‚ â”‚  nfl_2026   â”‚  â”‚
   â”‚  â”‚             â”‚ â”‚   (0.562)   â”‚ â”‚   (0.584)   â”‚ â”‚   (0.565)   â”‚  â”‚
   â”‚  â”‚  Top 3 foldsâ”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚  â”‚
   â”‚  â”‚  weighted   â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚  â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚
   â”‚         â”‚               â”‚               â”‚               â”‚          â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                                  â”‚
   â”‚  â”‚  nfl_gnn    â”‚ â”‚ nfl_mymodel â”‚                                  â”‚
   â”‚  â”‚   (0.580)   â”‚ â”‚   (0.577)   â”‚                                  â”‚
   â”‚  â”‚             â”‚ â”‚             â”‚                                  â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
   â”‚         â”‚               â”‚                                          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚               â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                      â”‚
   â”‚                      ENSEMBLE WEIGHTING                              â”‚
   â”‚                                                                      â”‚
   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â”‚  STEP 1: Open Source Ensemble (5 models Ã— 20% each)        â”‚   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â”‚  open_pred = 0.20 Ã— nfl_gru                                â”‚   â”‚
   â”‚   â”‚            + 0.20 Ã— nfl_gru3                               â”‚   â”‚
   â”‚   â”‚            + 0.20 Ã— nfl_2026                               â”‚   â”‚
   â”‚   â”‚            + 0.20 Ã— nfl_gnn                                â”‚   â”‚
   â”‚   â”‚            + 0.20 Ã— nfl_mymodel                            â”‚   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   â”‚                              â”‚                                      â”‚
   â”‚                              â–¼                                      â”‚
   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â”‚  STEP 2: CumsumModel (Internal weighted ensemble)          â”‚   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â”‚  cumsum_pred = 0.50 Ã— fold_4                               â”‚   â”‚
   â”‚   â”‚              + 0.30 Ã— fold_6                               â”‚   â”‚
   â”‚   â”‚              + 0.20 Ã— fold_9                               â”‚   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â”‚  (Best 3 folds selected by validation performance)         â”‚   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   â”‚                              â”‚                                      â”‚
   â”‚                              â–¼                                      â”‚
   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â”‚  STEP 3: Final Combination                                 â”‚   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â”‚  final_pred = 0.20 Ã— cumsum_pred + 0.80 Ã— open_pred        â”‚   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â”‚  Why 80% open source?                                      â”‚   â”‚
   â”‚   â”‚  â†’ They have better individual LB scores                   â”‚   â”‚
   â”‚   â”‚  â†’ Diversity helps (different architectures)               â”‚   â”‚
   â”‚   â”‚                                                             â”‚   â”‚
   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   â”‚                                                                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                      â”‚
   â”‚                       POST-PROCESSING                                â”‚
   â”‚                                                                      â”‚
   â”‚   1. Clip to field boundaries:                                      â”‚
   â”‚      x = clip(x, 0, 120)                                            â”‚
   â”‚      y = clip(y, 0, 53.3)                                           â”‚
   â”‚                                                                      â”‚
   â”‚   2. Restore original play direction:                               â”‚
   â”‚      if original_direction == 'left':                               â”‚
   â”‚          x = 120 - x                                                â”‚
   â”‚          y = 53.3 - y                                               â”‚
   â”‚                                                                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ FINAL OUTPUT  â”‚
                              â”‚               â”‚
                              â”‚  x, y coords  â”‚
                              â”‚  for each     â”‚
                              â”‚  frame_id     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ“š Glossary of Terms

| Term | Simple Explanation |
|------|-------------------|
| **Attention** | A mechanism that lets the model "focus" on important parts of the input, like how you pay more attention to key words when reading |
| **Batch** | A group of samples processed together for efficiency (e.g., 128 players at once) |
| **Bidirectional** | Processing a sequence both forward (pastâ†’future) and backward (futureâ†’past) |
| **Convolution (Conv1D)** | A sliding window that detects patterns, like finding "acceleration" patterns in movement |
| **Cumulative Sum (cumsum)** | Running total: [1,2,3] â†’ [1,3,6]. Used to convert velocity changes to positions |
| **Dropout** | Randomly "turning off" neurons during training to prevent overfitting |
| **Embedding** | Converting discrete categories into continuous numbers the model can process |
| **Epoch** | One complete pass through all training data |
| **Feature** | A measurable property of the data (e.g., speed, position, distance to ball) |
| **GELU** | An activation function (like a gate) that decides which signals pass through |
| **GNN** | Graph Neural Network - captures relationships between connected entities (players) |
| **GRU** | Gated Recurrent Unit - a type of memory cell that remembers important past information |
| **Hidden Dimension** | The internal size of the model's "thinking space" |
| **Layer Normalization** | Standardizing values in each layer to make training stable |
| **Learning Rate** | How big of steps the model takes when learning (too big = unstable, too small = slow) |
| **MLP** | Multi-Layer Perceptron - simple stacked layers that transform data |
| **Multi-Head Attention** | Running attention multiple times with different "perspectives" |
| **Positional Encoding** | Adding information about WHERE in the sequence each element is |
| **Residual Connection** | A shortcut that adds the input directly to the output (helps with deep networks) |
| **RMSE** | Root Mean Square Error - measures prediction accuracy (lower is better) |
| **Sequence** | Ordered data points over time (like frames of a movie) |
| **Softmax** | Converts numbers to probabilities that sum to 1 |
| **Transformer** | Architecture using attention to process sequences without recurrence |
| **Window Size** | How many past frames the model looks at to make predictions |

---

<p align="center">
  <br><br>
  <i>This documentation was created to help anyone understand<br>
  the complex world of trajectory prediction in sports analytics.</i>
</p>
